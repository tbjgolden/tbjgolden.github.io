<!-- post-title: The HTML button tag is a mess -->
<!-- post-timestamp: 1573710744896 -->

<h2 id="what-happens-when-you-click-a-button">What happens when you click a button?</h2>
<p>You would hope it would:</p>
<ul>
<li>fire its click event listeners</li>
<li>receive the browser focus</li>
<li>submit its parent <code>&lt;form&gt;</code> if it was given <code>type=&quot;submit&quot;</code></li>
</ul>
<h2 id="what-if-you-dont-use-a-pointing-device">What if you don&#39;t use a pointing device?</h2>
<p>You would hope they could:</p>
<ul>
<li>focus the button with the keyboard</li>
<li>simulate a button click (as specified above) by pressing either Enter or Space</li>
</ul>
<h2 id="awesome">Awesome!</h2>
<p>Except... the <code>&lt;button&gt;</code> tag doesn&#39;t do this.</p>
<p>At least, not consistently across all the major browsers.</p>
<p>Here&#39;s a <a href="https://allyjs.io/data-tables/focusable.html">link to a breakdown of different browsers input compatibility
inconsistencies</a>. There&#39;s a lot
there, because there&#39;s a lot of inconsistencies...</p>
<h2 id="so-how-do-we-do-it">So how do we do it?</h2>
<p>I explored a few alternatives and came to realize that the least worst solution
is to use <code>&lt;div tabindex=&quot;0&quot;&gt;</code>, with event listeners to &quot;polyfill&quot; (read: wrap
with secret functions) the default behavior of the <code>&lt;button&gt;</code> tag.</p>
<hr>
<p>Accessible buttons aren&#39;t particularly sexy, so here&#39;s some example React code
with some comments that highlight the main ideas behind an abstracted solution:</p>
<pre><code class="language-js">const React, { Fragment, useRef } from &#39;react&#39;;
const { number, string, func, bool } from &#39;prop-types&#39;;

const Button = ({
  onClick: _onClick,
  onKeyDown: _onKeyDown,
  tabIndex,
  type,
  ...props
}) =&gt; {
  const hiddenInputEl = useRef(null);

  // wrap click event to not fire the callback when disabled
  const onClick = ev =&gt; {
    if (!disabled) {
      _onClick(ev);
      // clicks the hidden input, if it has one - e.g. to trigger a form submit
      if (hiddenInputEl.current &amp;&amp; hiddenInputEl.current.click) {
        hiddenInputEl.current.click();
      }
    }
  };

  // wrap keydown event to call onClick when Enter or Space is pressed
  const onKeyDown = ev =&gt; {
    const { preventDefault } = ev;
    let preventedDefault = false;
    ev.preventDefault = (...args) =&gt; {
      preventedDefault = true;
      preventDefault.apply(ev, args);
    };
    _onKeyDown(ev);
    if (!preventedDefault &amp;&amp; [&#39; &#39;, &#39;Enter&#39;].includes(evt.keyCode)) {
      _onClick(ev);
    }
  };

  return (
    &lt;Fragment&gt;
      &lt;span
        onClick={onClick}
        onKeyDown={onKeyDown}
        tabIndex={tabIndex}
        type={type}
        {...props}
      /&gt;
      {
        (type === &#39;button&#39;)
          ? null
          : (
            // hidden input to polyfill type=&quot;submit&quot; and type=&quot;reset&quot; behavior
            &lt;input
              {...props}
              type={type}
              ref={hiddenInputEl}
              tabIndex={-1}
              style={{
                position: &#39;absolute&#39;,
                height: 1,
                width: 1,
                opacity: 0,
                overflow: &#39;hidden&#39;,
                pointerEvents: &#39;none&#39;,
                clip: &#39;rect(1px, 1px, 1px, 1px)&#39;
              }}
            /&gt;
          )
      }
    &lt;/Fragment&gt;
  );
};

Button.defaultProps = {
  tabIndex: 0,
  role: &quot;button&quot;,
  type: &quot;button&quot;,
  onClick: () =&gt; {},
  onKeyDown: () =&gt; {},
  disabled: false
};

Button.propTypes = {
  tabIndex: number.isRequired,
  role: string.isRequired,
  type: string.isRequired,
  onClick: func.isRequired,
  onKeyDown: func.isRequired,
  disabled: bool.isRequired
};</code></pre>
<p>If there&#39;s an error with the code, or you have some additional suggestions
please reach out to me by email and I&#39;ll get back to you! :)</p>
<p><code>flex-end</code></p>
